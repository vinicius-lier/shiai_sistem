{% extends 'atletas/base.html' %}

{% block title %}Dashboard - Sistema de Gest√£o de Competi√ß√µes de Jud√¥{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <p class="page-description">Vis√£o geral da competi√ß√£o e a√ß√µes r√°pidas</p>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Atletas</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_atletas }}</div>
        <div class="stat-card-change">Atletas cadastrados</div>
    </div>

    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Academias</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_academias }}</div>
        <div class="stat-card-change">Academias participantes</div>
    </div>

    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Categorias</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_categorias }}</div>
        <div class="stat-card-change">Categorias dispon√≠veis</div>
    </div>

    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Chaves</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_chaves }}</div>
        <div class="stat-card-change">Chaves geradas</div>
    </div>
</div>

<!-- Action Cards -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--spacing-6); margin-bottom: var(--spacing-8);">
    <div class="card">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div style="width: 48px; height: 48px; border-radius: var(--border-radius-md); background: var(--color-primary-light); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px;">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </div>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-1);">Cadastrar Atleta</h3>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">Adicionar novo atleta √† competi√ß√£o</p>
                </div>
            </div>
            <a href="{% url 'cadastrar_atleta' %}" class="btn btn-primary" style="width: 100%; justify-content: center;">
                Cadastrar
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div style="width: 48px; height: 48px; border-radius: var(--border-radius-md); background: var(--color-secondary-light); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px;">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                </div>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-1);">Gerar Chaves</h3>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">Criar chaves automaticamente</p>
                </div>
            </div>
            <a href="{% url 'lista_chaves' %}" class="btn btn-secondary" style="width: 100%; justify-content: center;">
                Gerar Chaves
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div style="width: 48px; height: 48px; border-radius: var(--border-radius-md); background: var(--color-success-light); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px;">
                        <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                    </svg>
                </div>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-1);">Pesagem</h3>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">Realizar pesagem dos atletas</p>
                </div>
            </div>
            <a href="{% url 'pesagem' %}" class="btn btn-secondary" style="width: 100%; justify-content: center;">
                Iniciar Pesagem
            </a>
        </div>
    </div>
</div>

<!-- Two Column Layout -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-6); margin-bottom: var(--spacing-8);">
    <!-- √öltimos Atletas -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">√öltimos Atletas Cadastrados</h3>
        </div>
        <div class="card-body" style="padding: 0;">
            {% if ultimos_atletas %}
                <div class="table-container" style="border: none; border-radius: 0;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Classe</th>
                                <th>Academia</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for atleta in ultimos_atletas %}
                            <tr>
                                <td>
                                    <div style="font-weight: 500; color: var(--color-gray-900);">{{ atleta.nome }}</div>
                                    <div style="font-size: var(--font-size-xs); color: var(--color-gray-500);">{{ atleta.get_sexo_display }}</div>
                                </td>
                                <td>
                                    <span class="badge badge-success">{{ atleta.classe }}</span>
                                </td>
                                <td style="font-size: var(--font-size-sm); color: var(--color-gray-600);">{{ atleta.academia.nome }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="empty-state" style="padding: var(--spacing-8);">
                    <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                    </svg>
                    <div class="empty-state-title">Nenhum atleta cadastrado</div>
                    <div class="empty-state-description">Comece cadastrando seu primeiro atleta</div>
                    <a href="{% url 'cadastrar_atleta' %}" class="btn btn-primary">Cadastrar Atleta</a>
                </div>
            {% endif %}
        </div>
        {% if ultimos_atletas %}
        <div class="card-footer">
            <a href="{% url 'lista_atletas' %}" class="btn btn-ghost" style="width: 100%; justify-content: center;">Ver Todos os Atletas</a>
        </div>
        {% endif %}
    </div>

    <!-- Ranking Preview -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Ranking de Academias</h3>
        </div>
        <div class="card-body" style="padding: 0;">
            {% if ranking_preview %}
                <div class="table-container" style="border: none; border-radius: 0;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">#</th>
                                <th>Academia</th>
                                <th style="text-align: right;">Pontos</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for academia in ranking_preview %}
                            <tr>
                                <td style="font-weight: 600; color: var(--color-gray-900);">
                                    {% if forloop.counter == 1 %}ü•á
                                    {% elif forloop.counter == 2 %}ü•à
                                    {% elif forloop.counter == 3 %}ü•â
                                    {% else %}{{ forloop.counter }}{% endif %}
                                </td>
                                <td>
                                    <div style="font-weight: 500; color: var(--color-gray-900);">{{ academia.nome }}</div>
                                    {% if academia.cidade %}<div style="font-size: var(--font-size-xs); color: var(--color-gray-500);">{{ academia.cidade }}{% if academia.estado %}, {{ academia.estado }}{% endif %}</div>{% endif %}
                                </td>
                                <td style="text-align: right;">
                                    <span style="font-weight: 600; color: var(--color-primary);">{{ academia.pontos }}</span>
                                    <span style="font-size: var(--font-size-xs); color: var(--color-gray-500);"> pts</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="empty-state" style="padding: var(--spacing-8);">
                    <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="20" x2="12" y2="10"></line>
                        <line x1="18" y1="20" x2="18" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="16"></line>
                    </svg>
                    <div class="empty-state-title">Nenhuma pontua√ß√£o ainda</div>
                    <div class="empty-state-description">As pontua√ß√µes aparecer√£o ap√≥s gerar chaves e registrar resultados</div>
                </div>
            {% endif %}
        </div>
        {% if ranking_preview %}
        <div class="card-footer">
            <a href="{% url 'ranking_academias' %}" class="btn btn-ghost" style="width: 100%; justify-content: center;">Ver Ranking Completo</a>
        </div>
        {% endif %}
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">A√ß√µes R√°pidas</h3>
    </div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-4);">
            <a href="{% url 'cadastrar_atleta' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                Cadastrar Atleta
            </a>
            <a href="{% url 'cadastrar_festival' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>
                Festival
            </a>
            <a href="{% url 'lista_academias' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
                Academias
            </a>
            <a href="{% url 'lista_categorias' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect></svg>
                Categorias
            </a>
            <a href="{% url 'lista_chaves' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                Chaves
            </a>
            <a href="{% url 'relatorio_atletas_inscritos' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                Relat√≥rios
            </a>
        </div>
    </div>
</div>

<style>
    @media (max-width: 1024px) {
        div[style*="grid-template-columns: 1fr 1fr"] {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}
