
{% extends 'atletas/layouts/base_operational.html' %}
{% load static %}

{% block title %}Categorias - Sistema de Gestão de Competições de Judô{% endblock %}

{% block content %}
<div class="page-header" style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: var(--spacing-4);">
    <div>
        <h1 class="page-title">Categorias</h1>
        <p class="page-description">Gerencie todas as categorias disponíveis</p>
    </div>
    <a href="{% url 'cadastrar_categoria' organizacao_slug=request.organizacao.slug %}" class="btn btn-primary">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
        Nova Categoria
    </a>
</div>

<!-- Filtros -->
<div class="card mb-6">
    <div class="card-header">
        <h3 class="card-title">Filtros</h3>
    </div>
    <div class="card-body">
        <form method="get">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="classe">Classe</label>
                    <select id="classe" name="classe" class="form-select">
                        <option value="">Todas</option>
                        {% for classe in classes %}
                        <option value="{{ classe }}" {% if classe == classe_filtro %}selected{% endif %}>{{ classe }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="sexo">Sexo</label>
                    <select id="sexo" name="sexo" class="form-select">
                        <option value="">Todos</option>
                        <option value="M" {% if sexo_filtro == 'M' %}selected{% endif %}>Masculino</option>
                        <option value="F" {% if sexo_filtro == 'F' %}selected{% endif %}>Feminino</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="categoria">Categoria</label>
                    <input type="text" id="categoria" name="categoria" value="{{ categoria_filtro }}" placeholder="Buscar categoria" class="form-input">
                </div>
            </div>
            <div class="action-row">
                <a href="{% url 'lista_categorias' organizacao_slug=request.organizacao.slug %}" class="btn btn-secondary">Limpar</a>
                <button type="submit" class="btn btn-primary">Aplicar Filtros</button>
            </div>
        </form>
    </div>
</div>

<!-- Tabela de Categorias -->
{% if categorias %}
<div class="table-container">
    <table class="table">
        <thead>
            <tr>
                <th>Classe</th>
                <th>Sexo</th>
                <th>Categoria</th>
                <th>Limite Mín (kg)</th>
                <th>Limite Máx (kg)</th>
                <th>Label</th>
            </tr>
        </thead>
        <tbody>
            {% for categoria in categorias %}
            <tr>
                <td>
                    <span class="badge badge-success">{{ categoria.classe.nome }}</span>
                </td>
                <td>
                    <span class="badge {% if categoria.sexo == 'M' %}badge-success{% else %}badge-warning{% endif %}">
                        {{ categoria.get_sexo_display }}
                    </span>
                </td>
                <td style="font-weight: 500; color: var(--color-gray-900);">{{ categoria.categoria_nome }}</td>
                <td style="font-size: var(--font-size-sm); color: var(--color-gray-700);">{{ categoria.limite_min }}</td>
                <td style="font-size: var(--font-size-sm); color: var(--color-gray-700);">
                    {% if categoria.limite_max and categoria.limite_max < 999.0 %}
                        {{ categoria.limite_max }}
                    {% else %}
                        {{ categoria.limite_min }} kg ou mais
                    {% endif %}
                </td>
                <td style="font-size: var(--font-size-sm); color: var(--color-gray-600);">{{ categoria.label }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" style="text-align: center;">Nenhuma categoria encontrada</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card">
    <div class="empty-state">
        <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        <div class="empty-state-title">Nenhuma categoria encontrada</div>
        <div class="empty-state-description">
            {% if classe_filtro or sexo_filtro or categoria_filtro %}
                Nenhuma categoria corresponde aos filtros aplicados.
            {% else %}
                Ainda não há categorias cadastradas.
            {% endif %}
        </div>
<a href="{% url 'cadastrar_categoria' organizacao_slug=request.organizacao.slug %}" class="btn btn-primary">Cadastrar Categoria</a>
    </div>
</div>
{% endif %}
{% endblock %}
