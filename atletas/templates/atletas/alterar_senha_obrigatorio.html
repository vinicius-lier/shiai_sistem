{% extends "atletas/layouts/base_auth.html" %}
{% load static %}

{% block title %}Alterar Senha - SHIAI SISTEM{% endblock %}

{% block auth_content %}
<div class="stack" style="align-items:center;">
  <img src="{% static 'atletas/images/logo_black.png' %}" alt="SHIAI SISTEM" style="width:110px; height:110px; object-fit:contain;">
  <div class="stack" style="gap: var(--space-1); text-align:center;">
    <div style="font-weight:800; font-size: var(--font-size-lg);">Alteração de Senha Obrigatória</div>
    <div style="color: var(--muted);">Por segurança, você precisa alterar sua senha no primeiro acesso</div>
  </div>
</div>

<form method="post" class="stack" style="margin-top: var(--space-4); gap: var(--space-3);">
  {% csrf_token %}

  <div class="stack" style="gap: var(--space-2);">
    <label for="senha_atual" style="font-weight:600;">Senha Atual</label>
    <input type="password" id="senha_atual" name="senha_atual" required placeholder="Digite sua senha atual" autocomplete="current-password" autofocus>
  </div>

  <div class="stack" style="gap: var(--space-2);">
    <label for="nova_senha" style="font-weight:600;">Nova Senha</label>
    <input type="password" id="nova_senha" name="nova_senha" required placeholder="Mínimo 6 caracteres" autocomplete="new-password" minlength="6">
    <div style="color: var(--muted); font-size: var(--font-size-xs);">A senha deve ter pelo menos 6 caracteres</div>
  </div>

  <div class="stack" style="gap: var(--space-2);">
    <label for="confirmar_senha" style="font-weight:600;">Confirmar Nova Senha</label>
    <input type="password" id="confirmar_senha" name="confirmar_senha" required placeholder="Digite a nova senha novamente" autocomplete="new-password" minlength="6">
  </div>

  <button type="submit" class="btn btn-primary" style="width:100%;">Alterar Senha</button>
</form>

<div class="alert alert-warning" style="margin-top: var(--space-3);">
  <strong>Importante:</strong> Você não poderá acessar o sistema até alterar sua senha.
</div>

<script>
// Validar se as senhas coincidem em tempo real (UX only)
document.getElementById('confirmar_senha')?.addEventListener('input', function() {
    const novaSenha = document.getElementById('nova_senha').value;
    const confirmarSenha = this.value;
    if (confirmarSenha && novaSenha !== confirmarSenha) {
        this.setCustomValidity('As senhas não coincidem');
    } else {
        this.setCustomValidity('');
    }
});
</script>
{% endblock %}

