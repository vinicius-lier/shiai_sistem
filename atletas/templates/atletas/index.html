{% extends 'atletas/base.html' %}

{% block title %}Dashboard - Sistema de Gest√£o de Competi√ß√µes de Jud√¥{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <p class="page-description">Vis√£o geral da competi√ß√£o e a√ß√µes r√°pidas</p>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Atletas</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_atletas }}</div>
        <div class="stat-card-change">Atletas cadastrados</div>
    </div>

    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Academias</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_academias }}</div>
        <div class="stat-card-change">Academias participantes</div>
    </div>

    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Inscri√ß√µes</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="8.5" cy="7" r="4"></circle>
                    <line x1="20" y1="8" x2="20" y2="14"></line>
                    <line x1="23" y1="11" x2="17" y2="11"></line>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_inscricoes }}</div>
        <div class="stat-card-change">Inscri√ß√µes no campeonato ativo</div>
    </div>

    <div class="stat-card">
        <div class="stat-card-header">
            <span class="stat-card-title">Total de Chaves</span>
            <div class="stat-card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 20px; height: 20px;">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
            </div>
        </div>
        <div class="stat-card-value">{{ total_chaves }}</div>
        <div class="stat-card-change">Chaves geradas</div>
    </div>
</div>

<!-- Action Cards -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--spacing-6); margin-bottom: var(--spacing-8);">
    <div class="card">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div style="width: 48px; height: 48px; border-radius: var(--border-radius-md); background: var(--color-primary-light); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px;">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </div>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-1);">Cadastrar Atleta</h3>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">Adicionar novo atleta √† competi√ß√£o</p>
                </div>
            </div>
            <a href="{% url 'cadastrar_atleta' %}" class="btn btn-primary" style="width: 100%; justify-content: center;">
                Cadastrar
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div style="width: 48px; height: 48px; border-radius: var(--border-radius-md); background: var(--color-secondary-light); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px;">
                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                </div>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-1);">Gerar Chaves</h3>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">Criar chaves automaticamente</p>
                </div>
            </div>
            <a href="{% url 'lista_chaves' %}" class="btn btn-secondary" style="width: 100%; justify-content: center;">
                Gerar Chaves
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div style="width: 48px; height: 48px; border-radius: var(--border-radius-md); background: var(--color-success-light); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px;">
                        <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <path d="M16 10a4 4 0 0 1-8 0"></path>
                    </svg>
                </div>
                <div>
                    <h3 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-1);">Pesagem</h3>
                    <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">Realizar pesagem dos atletas</p>
                </div>
            </div>
            <a href="{% url 'pesagem' %}" class="btn btn-secondary" style="width: 100%; justify-content: center;">
                Iniciar Pesagem
            </a>
        </div>
    </div>
</div>

<!-- Two Column Layout -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-6); margin-bottom: var(--spacing-8);">
    <!-- Ranking Preview -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Ranking de Academias</h3>
        </div>
        <div class="card-body" style="padding: 0;">
            {% if top_academias %}
                <div class="table-container" style="border: none; border-radius: 0;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">#</th>
                                <th>Academia</th>
                                <th style="text-align: right;">Pontos</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for pontuacao in top_academias %}
                            <tr>
                                <td style="font-weight: 600; color: var(--color-gray-900);">
                                    {% if forloop.counter == 1 %}ü•á
                                    {% elif forloop.counter == 2 %}ü•à
                                    {% elif forloop.counter == 3 %}ü•â
                                    {% else %}{{ forloop.counter }}{% endif %}
                                </td>
                                <td>
                                    <div style="font-weight: 500; color: var(--color-gray-900);">{{ pontuacao.academia.nome }}</div>
                                    {% if pontuacao.academia.cidade %}<div style="font-size: var(--font-size-xs); color: var(--color-gray-500);">{{ pontuacao.academia.cidade }}{% if pontuacao.academia.estado %}, {{ pontuacao.academia.estado }}{% endif %}</div>{% endif %}
                                </td>
                                <td style="text-align: right;">
                                    <span style="font-weight: 600; color: var(--color-primary);">{{ pontuacao.pontos_totais }}</span>
                                    <span style="font-size: var(--font-size-xs); color: var(--color-gray-500);"> pts</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="empty-state" style="padding: var(--spacing-8);">
                    <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="20" x2="12" y2="10"></line>
                        <line x1="18" y1="20" x2="18" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="16"></line>
                    </svg>
                    <div class="empty-state-title">Nenhuma pontua√ß√£o ainda</div>
                    <div class="empty-state-description">As pontua√ß√µes aparecer√£o ap√≥s gerar chaves e registrar resultados</div>
                </div>
            {% endif %}
        </div>
        {% if top_academias %}
        <div class="card-footer">
            <a href="{% url 'ranking_academias' %}" class="btn btn-ghost" style="width: 100%; justify-content: center;">Ver Ranking Completo</a>
        </div>
        {% endif %}
    </div>

    <!-- Campeonato Ativo -->
    {% if campeonato_ativo %}
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Campeonato Ativo</h3>
        </div>
        <div class="card-body">
            <div style="margin-bottom: var(--spacing-4);">
                <h4 style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-gray-900); margin: 0 0 var(--spacing-2);">{{ campeonato_ativo.nome }}</h4>
                {% if campeonato_ativo.data_competicao %}
                <p style="font-size: var(--font-size-sm); color: var(--color-gray-600); margin: 0;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: var(--spacing-1);">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    {{ campeonato_ativo.data_competicao|date:"d/m/Y" }}
                </p>
                {% endif %}
            </div>
            <a href="{% url 'lista_campeonatos' %}" class="btn btn-secondary" style="width: 100%; justify-content: center;">
                Gerenciar Campeonatos
            </a>
        </div>
    </div>
    {% endif %}
</div>

<!-- Quick Actions -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">A√ß√µes R√°pidas</h3>
    </div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-4);">
            <a href="{% url 'cadastrar_atleta' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                Cadastrar Atleta
            </a>
            <a href="{% url 'cadastrar_academia' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
                Cadastrar Academia
            </a>
            <a href="{% url 'lista_academias' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
                Academias
            </a>
            <a href="{% url 'lista_categorias' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect></svg>
                Categorias
            </a>
            <a href="{% url 'lista_chaves' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                Chaves
            </a>
            <a href="{% url 'administracao_painel' %}" class="btn btn-secondary" style="justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="3" x2="9" y2="21"></line></svg>
                Administra√ß√£o
            </a>
        </div>
    </div>
</div>

<style>
    @media (max-width: 1024px) {
        div[style*="grid-template-columns: 1fr 1fr"] {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}
