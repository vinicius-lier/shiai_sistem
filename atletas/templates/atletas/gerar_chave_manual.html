{% extends 'atletas/base.html' %}

{% block title %}Gerar Lutas Casadas{% endblock %}

{% block content %}
<<<<<<< HEAD
<div class="page-header" style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: var(--spacing-4);">
        <div>
        <h1 class="page-title">Gerar Lutas Casadas (Chave Manual)</h1>
        <p class="page-description">Monte uma chave manual escolhendo os atletas que irão lutar entre si</p>
    </div>
    <a href="{% url 'lista_chaves' %}" class="btn btn-secondary">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg>
        Voltar
    </a>
</div>

<div class="card mb-6">
    <div class="card-header">
        <h3 class="card-title">ℹ️ Informação</h3>
    </div>
    <div class="card-body">
        <p style="margin: 0; color: var(--color-gray-700);">
            Use esta tela para montar uma chave manual, escolhendo os atletas que irão lutar entre si. Esta chave <strong>não conta para o ranking</strong>, é apenas para lutas casadas.
        </p>
    </div>
</div>

<!-- Filtros -->
<div class="card mb-6">
    <div class="card-header">
        <h3 class="card-title">Filtros para facilitar seleção</h3>
    </div>
    <div class="card-body">
        <form method="get">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="nome">Nome</label>
                    <input type="text" id="nome" name="nome" value="{{ nome_filtro }}" placeholder="Buscar por nome" class="form-input">
        </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="classe">Classe</label>
                    <select id="classe" name="classe" class="form-select">
=======
<h1>Gerar Lutas Casadas (Chave Manual)</h1>

<p>Use esta tela para montar uma chave manual, escolhendo os atletas que irão lutar entre si. Esta chave <strong>não conta para o ranking</strong>, é apenas para lutas casadas.</p>

<div class="filter-box">
    <h3>Filtros para facilitar seleção</h3>
    <form method="get" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
        <div>
            <label for="nome">Nome:</label>
            <input type="text" id="nome" name="nome" value="{{ nome_filtro }}" placeholder="Buscar por nome" style="width: 100%;">
        </div>
        <div>
            <label for="classe">Classe:</label>
            <select id="classe" name="classe" style="width: 100%;">
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
                <option value="">Todas</option>
                {% for c in classes %}
                <option value="{{ c }}" {% if c == classe_filtro %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>
        </div>
<<<<<<< HEAD
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="sexo">Sexo</label>
                    <select id="sexo" name="sexo" class="form-select">
=======
        <div>
            <label for="sexo">Sexo:</label>
            <select id="sexo" name="sexo" style="width: 100%;">
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
                <option value="">Todos</option>
                <option value="M" {% if sexo_filtro == 'M' %}selected{% endif %}>Masculino</option>
                <option value="F" {% if sexo_filtro == 'F' %}selected{% endif %}>Feminino</option>
            </select>
        </div>
<<<<<<< HEAD
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="academia">Academia</label>
                    <select id="academia" name="academia" class="form-select">
=======
        <div>
            <label for="academia">Academia:</label>
            <select id="academia" name="academia" style="width: 100%;">
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
                <option value="">Todas</option>
                {% for acad in academias %}
                <option value="{{ acad.id }}" {% if acad.id|stringformat:"s" == academia_filtro|stringformat:"s" %}selected{% endif %}>{{ acad.nome }}</option>
                {% endfor %}
            </select>
        </div>
<<<<<<< HEAD
            </div>
            <div style="display: flex; gap: var(--spacing-3); justify-content: flex-end;">
                <a href="{% url 'gerar_chave_manual' %}" class="btn btn-secondary">Limpar Filtros</a>
                <button type="submit" class="btn btn-primary">Aplicar Filtros</button>
        </div>
    </form>
    </div>
=======
        <div style="display: flex; gap: 10px; align-items: flex-end;">
            <button type="submit" class="btn" style="flex: 1;">Aplicar filtros</button>
            <a href="{% url 'gerar_chave_manual' %}" class="btn" style="flex: 1; text-align: center;">Limpar</a>
        </div>
    </form>
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
</div>

<form method="post">
    {% csrf_token %}

<<<<<<< HEAD
    <!-- Configuração da Chave -->
    <div class="card mb-6">
        <div class="card-header">
            <h3 class="card-title">Configuração da Chave</h3>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-4);">
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="nome_chave">Nome da chave</label>
                    <input type="text" id="nome_chave" name="nome_chave" placeholder="Ex.: Lutas casadas SUB 11 Misto" class="form-input" required>
            </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="classe_chave">Classe (opcional)</label>
                    <input type="text" id="classe_chave" name="classe_chave" placeholder="Ex.: SUB 11" class="form-input">
            </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label class="form-label" for="sexo_chave">Sexo da chave</label>
                    <select id="sexo_chave" name="sexo_chave" class="form-select" required>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
                </div>
=======
    <div class="filter-box">
        <h3>Configuração da Chave</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
            <div>
                <label for="nome_chave">Nome da chave:</label>
                <input type="text" id="nome_chave" name="nome_chave" placeholder="Ex.: Lutas casadas SUB 11 Misto" style="width: 100%;">
            </div>
            <div>
                <label for="classe_chave">Classe (opcional):</label>
                <input type="text" id="classe_chave" name="classe_chave" placeholder="Ex.: SUB 11" style="width: 100%;">
            </div>
            <div>
                <label for="sexo_chave">Sexo da chave:</label>
                <select id="sexo_chave" name="sexo_chave" style="width: 100%;">
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
            </div>
        </div>
    </div>

<<<<<<< HEAD
    <!-- Tabela de Atletas -->
    {% if atletas %}
    <div class="card mb-6">
        <div class="card-header">
            <h3 class="card-title">Selecione os Atletas</h3>
        </div>
        <div class="card-body" style="padding: 0;">
            <div class="table-container">
                <table class="table">
            <thead>
                <tr>
                            <th style="width: 50px; text-align: center;">
                                <input type="checkbox" id="select-all" onchange="toggleSelectAll(this)">
                            </th>
=======
    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th style="width: 40px;">Sel.</th>
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
                    <th>Nome</th>
                    <th>Classe</th>
                    <th>Sexo</th>
                    <th>Categoria</th>
                    <th>Faixa</th>
                    <th>Academia</th>
                </tr>
            </thead>
            <tbody>
                {% for atleta in atletas %}
                <tr>
                    <td style="text-align: center;">
<<<<<<< HEAD
                                <label class="form-checkbox" style="justify-content: center;">
                                    <input type="checkbox" name="atletas" value="{{ atleta.id }}" class="atleta-checkbox">
                                    <span class="checkbox-indicator"></span>
                                </label>
                            </td>
                            <td>
                                <div style="font-weight: 500; color: var(--color-gray-900);">{{ atleta.nome }}</div>
                            </td>
                            <td>
                                <span class="badge badge-success">{{ atleta.get_classe_atual|default:atleta.classe_inicial|default:"SÊNIOR" }}</span>
                            </td>
                            <td>
                                <span class="badge {% if atleta.sexo == 'M' %}badge-success{% else %}badge-warning{% endif %}">
                                    {{ atleta.get_sexo_display }}
                                </span>
                            </td>
                            <td style="font-size: var(--font-size-sm); color: var(--color-gray-700);">
                                -
                            </td>
                            <td style="font-size: var(--font-size-sm); color: var(--color-gray-600);">
                                {{ atleta.faixa }}
                            </td>
                            <td style="font-size: var(--font-size-sm); color: var(--color-gray-600);">
                                {{ atleta.academia.nome }}
                    </td>
=======
                        <input type="checkbox" name="atletas" value="{{ atleta.id }}">
                    </td>
                    <td>{{ atleta.nome }}</td>
                    <td>{{ atleta.classe }}</td>
                    <td>{{ atleta.get_sexo_display }}</td>
                    <td>{{ atleta.categoria_ajustada|default:atleta.categoria_nome }}</td>
                    <td>{{ atleta.faixa }}</td>
                    <td>{{ atleta.academia.nome }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7" style="text-align: center;">Nenhum atleta encontrado com os filtros atuais</td>
>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
                </tr>
                {% endfor %}
            </tbody>
        </table>
<<<<<<< HEAD
            </div>
        </div>
    </div>

    <div class="card mb-6">
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--spacing-3); padding: var(--spacing-3); background: var(--color-primary-light); border-radius: var(--border-radius-md);">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px; flex-shrink: 0;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 16v-4M12 8h.01"></path>
                </svg>
                <p style="margin: 0; color: var(--color-gray-700); font-size: var(--font-size-sm);">
        Os atletas serão pareados em ordem de seleção: 1 x 2, 3 x 4, 5 x 6, etc. Se houver atleta sobrando, ele ficará em WO.
    </p>
            </div>
        </div>
    </div>

    <div style="display: flex; gap: var(--spacing-3); justify-content: flex-end;">
        <a href="{% url 'lista_chaves' %}" class="btn btn-secondary">Cancelar</a>
        <button type="submit" class="btn btn-success">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
            Gerar Lutas Casadas
        </button>
    </div>
    {% else %}
    <div class="card">
        <div class="empty-state">
            <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
            </svg>
            <div class="empty-state-title">Nenhum atleta encontrado</div>
            <div class="empty-state-description">Nenhum atleta corresponde aos filtros aplicados. Tente ajustar os filtros acima.</div>
        </div>
    </div>
    {% endif %}
</form>

<script>
function toggleSelectAll(checkbox) {
    const checkboxes = document.querySelectorAll('.atleta-checkbox');
    checkboxes.forEach(cb => {
        cb.checked = checkbox.checked;
    });
}

// Verificar se todos estão selecionados quando um é clicado
document.querySelectorAll('.atleta-checkbox').forEach(checkbox => {
    checkbox.addEventListener('change', function() {
        const allCheckboxes = document.querySelectorAll('.atleta-checkbox');
        const checkedCheckboxes = document.querySelectorAll('.atleta-checkbox:checked');
        document.getElementById('select-all').checked = allCheckboxes.length === checkedCheckboxes.length;
    });
});
</script>
=======
    </div>

    <p style="margin-top: 10px; font-size: 14px;">
        Os atletas serão pareados em ordem de seleção: 1 x 2, 3 x 4, 5 x 6, etc. Se houver atleta sobrando, ele ficará em WO.
    </p>

    <button type="submit" class="btn btn-success">Gerar Lutas Casadas</button>
    <a href="{% url 'lista_chaves' %}" class="btn">Voltar</a>
</form>

>>>>>>> dd494c57289dd9cfb039519c18e2065bb3b48a17
{% endblock %}


